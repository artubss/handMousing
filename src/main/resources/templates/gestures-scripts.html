<!-- Scripts da P√°gina de Gestos -->
<div th:fragment="scripts">
  <script>
    let gestureHistory = [];
    let currentGesture = null;

    function updateGestureDisplay(gesture) {
      const display = document.getElementById("gestureDisplay");
      const lastGesture = document.getElementById("lastGesture");
      const confidence = document.getElementById("gestureConfidence");

      if (gesture) {
        display.innerHTML = `
          <i class="fas fa-hand-paper fa-4x text-success"></i>
          <p class="mt-3 text-success">${
            gesture.displayName || "Gesto detectado"
          }</p>
        `;
        lastGesture.textContent = gesture.displayName || "Desconhecido";
        confidence.textContent =
          Math.round((gesture.confidence || 0) * 100) + "%";

        // Adiciona ao hist√≥rico
        gestureHistory.unshift({
          gesture: gesture.displayName,
          confidence: gesture.confidence,
          timestamp: new Date(),
        });

        // Limita hist√≥rico a 10 itens
        if (gestureHistory.length > 10) {
          gestureHistory.pop();
        }

        currentGesture = gesture;
      } else {
        display.innerHTML = `
          <i class="fas fa-hand-paper fa-4x text-muted"></i>
          <p class="mt-3 text-muted">Aguardando gestos...</p>
        `;
      }
    }

    function updateGestureHistory() {
      // Aqui voc√™ pode implementar a atualiza√ß√£o do hist√≥rico
      // Por enquanto, apenas mantemos os dados em mem√≥ria
    }

    // Fun√ß√£o para obter gestos do servidor
    function fetchGestures() {
      fetch("/api/status")
        .then((response) => response.json())
        .then((data) => {
          if (data.lastGesture) {
            updateGestureDisplay(data.lastGesture);
          }
          if (data.gestureConfidence !== undefined) {
            document.getElementById("gestureConfidence").textContent =
              Math.round(data.gestureConfidence * 100) + "%";
          }
        })
        .catch((error) => {
          console.error("Erro ao obter gestos:", error);
        });
    }

    // Event listeners para configura√ß√µes
    document
      .getElementById("enableGestures")
      .addEventListener("change", function () {
        console.log(
          "Reconhecimento de gestos:",
          this.checked ? "habilitado" : "desabilitado"
        );
      });

    document
      .getElementById("showLandmarks")
      .addEventListener("change", function () {
        console.log("Landmarks:", this.checked ? "vis√≠veis" : "ocultos");
      });

    document
      .getElementById("enableSound")
      .addEventListener("change", function () {
        console.log(
          "Som de feedback:",
          this.checked ? "habilitado" : "desabilitado"
        );
      });

    // Inicializa√ß√£o
    document.addEventListener("DOMContentLoaded", function () {
      console.log("ü§ö P√°gina de gestos carregada");

      // Atualiza gestos a cada segundo
      setInterval(fetchGestures, 1000);

      // Atualiza√ß√£o inicial
      fetchGestures();
    });
  </script>
</div>
